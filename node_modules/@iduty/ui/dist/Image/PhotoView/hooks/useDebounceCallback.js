"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const react_1 = require("react");
function useDebounceCallback(callback, { leading = false, maxWait, wait = maxWait || 0, }) {
    const callbackRef = (0, react_1.useRef)(callback);
    callbackRef.current = callback;
    const prev = (0, react_1.useRef)(0);
    const trailingTimeout = (0, react_1.useRef)();
    const clearTrailing = () => trailingTimeout.current && clearTimeout(trailingTimeout.current);
    const fn = (0, react_1.useCallback)((...args) => {
        const now = Date.now();
        function call() {
            prev.current = now;
            clearTrailing();
            callbackRef.current.apply(null, args);
        }
        const last = prev.current;
        const offset = now - last;
        if (last === 0) {
            if (leading) {
                call();
            }
            prev.current = now;
        }
        if (maxWait !== undefined) {
            if (offset > maxWait) {
                call();
                return;
            }
        }
        else if (offset < wait) {
            prev.current = now;
        }
        clearTrailing();
        trailingTimeout.current = setTimeout(() => {
            call();
            prev.current = 0;
        }, wait);
    }, [wait, maxWait, leading]);
    fn.cancel = clearTrailing;
    return fn;
}
exports.default = useDebounceCallback;
